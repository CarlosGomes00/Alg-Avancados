def bwt_transf(seq):

    seq += '$'
    
    rotations = [seq[i:] + seq[:i] for i in range(len(seq))]
    rotations.sort()

    bwt = ''.join(rotation[-1] for rotation in rotations)

    return bwt, rotations.index(seq)

def bwt_reverse(bwt):
    table = [None] * len(bwt)

    for _ in range(len(bwt)):
        table = [bwt[i] + (table[i] if table[i] is not None else '') for i in range(len(bwt))]

        table.sort()

    return table[bwt.index('$')]
